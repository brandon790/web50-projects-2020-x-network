{% extends "network/layout.html" %}

{% block body %}

{% if message %}
    <div>{{ message }}</div>
{% endif %}

<form action="{% url 'new_post' %}" method="post">
    {% csrf_token %}
    <div id="all-posts-head">
        <h3>All Posts</h3>
        <div style="border-style: solid;margin: 15px;border-width: thin;">
            <h4 style="margin-left: 10px;">New Post</h4>
                <textarea rows="4" cols="202" style="margin-left: 10px" name="post_content"></textarea>
                <input style="margin-left: 10px;" type="submit" value="Post">
            </div>
        </form>
  
        <form action="{% url 'profile' %}" method="GET">
        {% for item in page_obj %}
        <h5 style="border-style: solid;margin: 15px;border-width: thin;">
            <div>
                <input type="submit" name="user" value="{{ item.user }}" style="background:none; border-width:0px; color:black; text-decoration:underline;" />
            </div>
            <div id="post_{{ item.id }}"> {{ item.content }}</div>
            <div>{{ item.timestamp }}</div>
            <div>{{ item.likes }}</div>
            {% if item.user == request.user %}

            <button type="button" id="save_edit_{{ item.id }}" onclick="test_alert()">Save</button>
            <button type="button" id="edit_post_{{ item.id }}" onclick='document.getElementById("post_{{ item.id }}").innerHTML = "<textarea>{{ item.content }}</textarea>"'>Edit</button>
            
            <button type="button" onclick="test_alert()">Try</button>

            <script>
                function test_alert() {
                    alert("yes");

                /* //in progess
                document.addEventListener('DOMContentLoaded', function() {
                document.getElementById("save_edit_{{ item.id }}").addEventListener("click", test_alert, false);
                
                }}

                var x = document.getElementById("post_{{ item.id }}").value;
                var update_save = {
                    user = "{{ item.user }}",
                    content = x,
                    timestamp = "{{ item.timestamp }}",
                    likes = "{{ item.likes }}"};
                    update_save.save();
                }) */

              </script>

            {% endif %}
        </h5>
        <br>  
        {% endfor %}

<div class="pagination">
    <span class="step-links">
        {% if page_obj.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">next</a>
            <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>

        </form>
        </div>


{% endblock %}
